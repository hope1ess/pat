一遍AC
```c++
#include <iostream>
#include <algorithm>
#include <string>
#include <vector>
using namespace std;
struct Person
{
	string id;
	int final_rank;
	int location_number;
	int local_rank;
	int score;
};
bool cmp(Person p1, Person p2)
{
	if (p1.score != p2.score)
		return p1.score > p2.score;
	else
		return p1.id < p2.id;
}
int main()
{
	vector<Person> v;
	int n;
	cin >> n;
	int count = 0;
	for (int i = 0; i < n; ++i)
	{
		int pre_count = count;
		int k;
		cin >> k;
		for (int j = 0; j < k; ++j)
		{
			Person p;
			cin >> p.id >> p.score;
			p.location_number = i + 1;
			++count;
			v.push_back(p);
		}
		sort(v.begin() + pre_count, v.end(), cmp);
		for (int j = pre_count, rank = 1; j < k + pre_count; ++j)
		{
			if (j == 0 || v[j - 1].score != v[j].score)
				v[j].local_rank = rank;
			else
				v[j].local_rank = v[j - 1].local_rank;
			++rank;
		}
	}
	cout << count << endl;
	sort(v.begin(), v.end(), cmp);
	for (int i = 0, rank = 1; i < count; ++i)
	{
		if (i == 0 || v[i - 1].score != v[i].score)
			v[i].final_rank = rank;
		else
			v[i].final_rank = v[i - 1].final_rank;
		++rank;
		cout << v[i].id << " " << v[i].final_rank << " " << v[i].location_number << " " << v[i].local_rank << endl;
	}
	system("pause");
	return 0;
}
```